<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
</head>
<body class="container">
    <form onsubmit="savetolocalstorage(event)">
        <label for="expense" >Expenses</label>
        <input type="number" name="expense" id="expense" placeholder="enter expense">
        <label for="description" >Description</label>
        <input type="text" name="description" placeholder="enter description" id="description">
        <label for="category" >Category</label>
        
        <!-- <input type="text" name="category" placeholder="enter category" id="category"> -->
        <select id="category" name="category">
            <option value="shopping">shopping</option>
            <option value="food">food</option>
            <option value="party">party</option>
            <option value="rent">rent</option>
          </select>
        <button type="submit">Submit</button>
    </form>
    <ul id="listofitem"></ul>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.6/axios.min.js"></script>
    <script>
        function savetolocalstorage(event){
            
            event.preventDefault();
            
            const expense = event.target.expense.value;
            const description = event.target.description.value;
            const category = event.target.category.value;
        
            const obj = {
                expense,
                description,
                category
            }
            axios.post("https://crudcrud.com/api/5e012380503c41af82c0bd27e5881f7f/apoinment",obj)
            .then((response)=>{
                showonscreen(response.data)
                // console.log(response)
            })
            .catch((err)=>{
                document.body.innerHTML = document.body.innerHTML + "<h4>somthing went wrong</h4>"
                console.log(err)
            })
            // localStorage.setItem(obj.description, JSON.stringify(obj));
            // showonscreen(obj)
        }
   window.addEventListener("DOMContentLoaded",()=>{
    // console.log(11);
    axios.get("https://crudcrud.com/api/5e012380503c41af82c0bd27e5881f7f/apoinment")
    .then((response)=>{
        for(let i=0; i<response.data.length; i++){
            showonscreen(response.data[i]);
        }
    })
    .catch((err)=>console.log(err))
   })
        function showonscreen(obj){
            const parentele = document.getElementById('listofitem');
            const childele = document.createElement('li');
            childele.textContent = obj.expense+'-'+obj.description+'-'+obj.category
            parentele.appendChild(childele);
            
            const deletebtn = document.createElement('input')
            deletebtn.type = "button"
            deletebtn.value = "delete expense"
            deletebtn.onclick = () => {
            axios.delete(`https://crudcrud.com/api/5e012380503c41af82c0bd27e5881f7f/apoinment/${obj._id}`)
             localStorage.removeItem(obj.expense)
             parentele.removeChild(childele)
            }
            childele.appendChild(deletebtn);
            const editbtn = document.createElement('input')
            editbtn.type = "button"
            editbtn.value = "edit expense"

            editbtn.onclick = () =>{
                  document.getElementById('expense').value = obj.expense
                  document.getElementById('description').value = obj.description
                  document.getElementById('category').value = obj.category
                  localStorage.removeItem(obj.expense)
                  parentele.removeChild(childele)
            }
            childele.appendChild(editbtn)
        }
    </script>
    
</body>
</html>